---
import Layout from "../../layouts/Layout.astro";
import ShowCode from "../../components/ShowCode";
import Comments from "../../components/Comments";
import { getPostById } from "../../lib/posts";
import { getCommentsByPostId } from "../../lib/comments";

const { id } = Astro.params;
const post = getPostById(id as string);
console.log("Post", post);
if (!post) {
    return Astro.redirect("/");
}

const comments = await getCommentsByPostId(id as string);
---

<Layout title="Scriptia - PublicaciÃ³n" activeTab="post">
    <h2 class="text-neutral-300 font-display text-4xl font-bold uppercase">{post.title}</h2>
    <p class="text-neutral-500 mb-4">{post.description}</p>
    <ShowCode code={post.code} client:load />
    <h4 class="text-neutral-300 text-2xl font-bold my-4">
        Comentarios:
    </h4>
    <Comments postId={post.id} comments={comments} client:load />
</Layout>
